import streamlit as st
import pandas as pd

st.set_page_config(page_title="House Price EDA ‚Äî Kaggle", layout="wide")

# ----- Title -----
st.title("üè† EDA –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ ‚Äî Kaggle House Prices")

st.markdown('---')

st.markdown(
    "–≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ—Å–≤—è—â–µ–Ω–∞ –æ–ø–∏—Å–∞–Ω–∏—é —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏ –∏ –≥—Ä–∞—Ñ–∏–∫–∞–º, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–º –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ EDA.\n\n"
)
st.write("""
- –ö–æ—à–µ–ª–µ–≤ –î–º–∏—Ç—Ä–∏–π
- –õ—é–±–æ–≤—å –°—Ç—Ä–∏–∂–æ–≤–∞
- –Ø—Ä–æ—Å–ª–∞–≤ –ü–∞—Ö–æ–º–æ–≤
""")

from PIL import Image
import streamlit as st

# ----- Graph Descriptions with adaptive width and fixed height -----
def graph_section(title, description, file_path, height=600):
    st.header(title)
    st.write(description)
    
    img = Image.open(file_path).convert('RGB')
    
    img = Image.open(file_path).convert("RGB")  # –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ RGB
    width = int(img.width * (height / img.height))
    img_resized = img.resize((width, height))
    st.image(img_resized)

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤
graph_section(
    "1) –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (SalePrice)",
    "–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã train/valid –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è –∏ –Ω–∞–ª–∏—á–∏–µ –∞—Å–∏–º–º–µ—Ç—Ä–∏–∏ ‚Äî –¥–æ—Ä–æ–≥–∏–µ –¥–æ–º–∞ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç –¥–ª–∏–Ω–Ω—ã–π —Ö–≤–æ—Å—Ç",
    "picture/image1.png"
)

graph_section(
    "2) –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤",
    "–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞–ª–∏—á–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤ –∏ —Å–∫–æ—à–µ–Ω–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—Ä–æ–≤–∞–Ω–∏—è",
    "picture/image.png"
)

graph_section(
    "3) –ß–∞—Å—Ç–æ—Ç–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤",
    "–°—Ç–æ–ª–±—á–∞—Ç—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É—é—Ç –¥–∏—Å–±–∞–ª–∞–Ω—Å –∫–∞—Ç–µ–≥–æ—Ä–∏–π ‚Äî –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è —á–∞—Å—Ç–æ, —Ä–µ–¥–∫–∏–µ –Ω—É–∂–Ω–æ –∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ –∏–ª–∏ –æ–±—ä–µ–¥–∏–Ω—è—Ç—å.",
    "picture/image7.png"
)

graph_section(
    "4) –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞",
    "–¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—è–≤–∏—Ç—å –≥—Ä—É–ø–ø—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å —Å–∏–ª—å–Ω–æ–π –≤–∑–∞–∏–º–æ—Å–≤—è–∑—å—é –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—É—é –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å.",
    "picture/image6.png"
)

graph_section(
    "5) –¢–æ–ø-–ø—Ä–∏–∑–Ω–∞–∫–∏ –ø–æ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å SalePrice",
    "–ë–∞—Ä—á–∞—Ä—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç, —á—Ç–æ —Ç–∞–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, –∫–∞–∫ –∫–∞—á–µ—Å—Ç–≤–æ –¥–æ–º–∞ (OverallQual) –∏ –∂–∏–ª–∞—è –ø–ª–æ—â–∞–¥—å (GrLivArea), —Å–∏–ª—å–Ω–µ–µ –≤—Å–µ–≥–æ —Å–≤—è–∑–∞–Ω—ã —Å —Ü–µ–Ω–æ–π.",
    "picture/image8.png"
)

graph_section(
    "6) –ü–æ–ª–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏",
    "–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∫ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ, —Ç–∞–∫ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–æ–∑—Ä–∞—Å—Ç –¥–æ–º–∞ —Å–Ω–∏–∂–∞–µ—Ç —Ü–µ–Ω—É.",
    "picture/image5.png"
)

# ----- Recommendations -----
st.markdown('---')
st.header('–û—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞')
st.markdown(
    '- –¶–µ–Ω–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–∞—á–µ—Å—Ç–≤–∞, –ø–ª–æ—â–∞–¥–∏ –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –≥–∞—Ä–∞–∂–∞/–ø–æ–¥–≤–∞–ª–∞.\n'
    '- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–∫–æ—à–µ–Ω—ã ‚Äî –ø–æ–ª–µ–∑–Ω–æ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—Ä–æ–≤–∞—Ç—å —Ç–∞—Ä–≥–µ—Ç –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ–∏—á–∏.\n'
    '- –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –Ω—É–∂–Ω–æ –∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å —Å —É—á—ë—Ç–æ–º —Ä–µ–¥–∫–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π.\n'
    '- –î–ª—è –±–æ—Ä—å–±—ã —Å –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å—é —Å—Ç–æ–∏—Ç –æ—Ç–±–∏—Ä–∞—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏–ª–∏ –ø—Ä–∏–º–µ–Ω—è—Ç—å —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é.'
)



# ----- Model Description Section -----

st.markdown('---')
st.header("–≠—Ç–∞–ø—ã —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã")

st.subheader("1) –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ —Ç–∏–ø—É")
st.write("""
- –ß–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (`num_cols`) –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –º–µ–¥–∏–∞–Ω–Ω–æ–π –∏–º–ø—É—Ç–∞—Ü–∏–µ–π.
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å ‚â§3 —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ (`cat_cols_small`) –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ One-Hot Encoding.
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å >3 —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ (`cat_cols_large`) –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ Ordinal Encoding.
""")

st.subheader("2) –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤")
st.write("""
- num_pipe ‚Üí –º–µ–¥–∏–∞–Ω–Ω–∞—è –∏–º–ø—É—Ç–∞—Ü–∏—è + StandardScaler
- small_cat_pipe ‚Üí –∏–º–ø—É—Ç–∞—Ü–∏—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ–π "None" + OneHotEncoder
- large_cat_pipe ‚Üí –∏–º–ø—É—Ç–∞—Ü–∏—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ–π "None" + OrdinalEncoder
- –í—Å–µ –ø–∞–π–ø–ª–∞–π–Ω—ã –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –≤ ColumnTransformer –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
""")

st.subheader("3) –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞—Ä–≥–µ—Ç–∞")
st.write("`y_train` –∏ y_valid –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ np.log1p –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∞ –¥–ª–∏–Ω–Ω–æ–≥–æ —Ö–≤–æ—Å—Ç–∞ —Ü–µ–Ω –¥–æ–º–æ–≤.")

st.subheader("4) –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏")
st.write("""
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω CatBoostRegressor —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: 1000 –∏—Ç–µ—Ä–∞—Ü–∏–π, –≥–ª—É–±–∏–Ω–∞ 6, learning_rate 0.1, L2-—Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è 10
- –ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ü–µ–Ω–∞—Ö –ø–æ—Å–ª–µ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —á–µ—Ä–µ–∑ –æ–±—â–∏–π –ø–∞–π–ø–ª–∞–π–Ω
""")

st.subheader("5) –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏")
st.write("""
- –ü—Ä–æ–≥–Ω–æ–∑ –≤–æ–∑–≤—Ä–∞—â—ë–Ω –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —á–µ—Ä–µ–∑ np.expm1
- –ú–µ—Ç—Ä–∏–∫–∏ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:
  - RMSLE ‚âà 0.12‚Äì0.13  
  - R¬≤ ‚âà 0.90
- –ë—ã–ª–∏ –≤—ã—è–≤–ª–µ–Ω—ã –ø–æ—á—Ç–∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏ —Å–∏–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏–µ –ø–∞—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –±—ã–ª–æ –∏—Å–∫–ª—é—á–∏—Ç—å –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –º–æ–¥–µ–ª–∏
""")

st.subheader("6) –ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤")
st.write("""
- –ü–æ–ª—É—á–µ–Ω—ã –≤–∞–∂–Ω–æ—Å—Ç–∏ –æ—Ç CatBoost –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- –í–∞–∂–Ω–æ—Å—Ç–∏ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –∏—Å—Ö–æ–¥–Ω—ã–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º –¥–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏
- –û—Ç–æ–±—Ä–∞–Ω—ã –Ω–∞–∏–±–æ–ª–µ–µ –∑–Ω–∞—á–∏–º—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (–≤–µ—Ä—Ö–Ω–∏–µ 75% –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏) –¥–ª—è —Å–æ–∫—Ä–∞—â—ë–Ω–Ω–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞
""")

st.subheader("7) –û–±—É—á–µ–Ω–∏–µ —É–ø—Ä–æ—â—ë–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏")
st.write("""
- –ù–æ–≤—ã–π –ø–∞–π–ø–ª–∞–π–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ –æ—Ç–æ–±—Ä–∞–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
- –ú–µ—Ç—Ä–∏–∫–∏ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –æ—Ç–±–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:
  - RMLSE ‚âà 0.12  
  - R¬≤ ‚âà 0.90
- –ü–æ–∫–∞–∑–∞–Ω–æ, —á—Ç–æ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ —á–∏—Å–ª–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–µ —É—Ö—É–¥—à–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏
""")

st.subheader("–û—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã")
st.write("""
- –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, –≤–ª–∏—è—é—â–∏–µ –Ω–∞ —Ü–µ–Ω—É:
  - OverallQual, GrLivArea, GarageCars, TotalBsmtSF, YearBuilt
- –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞—Ä–≥–µ—Ç–∞ –∏ —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –ø–æ–º–æ–≥–ª–∏ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ
- –û—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ–∑–≤–æ–ª–∏–ª —É–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä –ø–∞–π–ø–ª–∞–π–Ω–∞ –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –∫–∞—á–µ—Å—Ç–≤–∞
""")

# Res Models
st.markdown('---')
st.header("–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–¥–µ–ª–µ–π")

st.write(
    "–î–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞–∑–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ –±—ã–ª–∏ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã –º–µ—Ç—Ä–∏–∫–∏ RMSLE, R2, RMSE –∏ MAE. "
    "–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏."
)

results = [
    {"Model": "CatBoost", "RMSLE": 0.1165, "R2": 0.9026, "RMSE": 24988.41, "MAE": 14724.46},
    {"Model": "Ridge", "RMSLE": 0.1315, "R2": 0.8913, "RMSE": 24988.41, "MAE": 14724.46},
    {"Model": "RandomForest", "RMSLE": 0.1265, "R2": 0.8987, "RMSE": 25485.52, "MAE": 15768.62},
    {"Model": "Lasso", "RMSLE": 0.1370, "R2": 0.8783, "RMSE": 25485.52, "MAE": 15768.62},
    {"Model": "GradientBoosting", "RMSLE": 0.1216, "R2": 0.8953, "RMSE": 25904.35, "MAE": 15536.20},
    {"Model": "HistGradientBoosting", "RMSLE": 0.1213, "R2": 0.9121, "RMSE": 23738.60, "MAE": 14743.04},
    {"Model": "KNN", "RMSLE": 0.1992, "R2": 0.7543, "RMSE": 39687.36, "MAE": 24477.19},
]

df_results = pd.DataFrame(results).set_index("Model")
st.dataframe(df_results.style.format("{:.4f}"))